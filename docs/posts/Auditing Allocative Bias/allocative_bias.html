<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Anweshan Adhikari">
<meta name="description" content="Exploring the impact of algorithmic decision making on equality">

<title>Anweshan’s Blog - Auditing Allocative Bias</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Anweshan’s Blog</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About me</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction-to-the-dataset" id="toc-introduction-to-the-dataset" class="nav-link active" data-scroll-target="#introduction-to-the-dataset">Introduction to the dataset</a></li>
  <li><a href="#basic-descriptives" id="toc-basic-descriptives" class="nav-link" data-scroll-target="#basic-descriptives">Basic Descriptives</a></li>
  <li><a href="#implementing-a-model" id="toc-implementing-a-model" class="nav-link" data-scroll-target="#implementing-a-model">Implementing a Model</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Auditing Allocative Bias</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li></ul></div></div>
</div>

<div>
  <div class="description">
    Exploring the impact of algorithmic decision making on equality
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Anweshan Adhikari </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="introduction-to-the-dataset" class="level1">
<h1>Introduction to the dataset</h1>
<p>In this blog, we will be working with data from American Community Survey using the ACSDataSource class. Each row in our datset represents an individual who took the PUMA survey in Colorado, USA. First, let’s have a look at our dataset:.</p>
<div class="cell" data-execution_count="1">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">from</span> folktables <span class="im">import</span> ACSDataSource, ACSEmployment, BasicProblem, adult_filter</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a>STATE <span class="op">=</span> <span class="st">"CO"</span></span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a>data_source <span class="op">=</span> ACSDataSource(survey_year<span class="op">=</span><span class="st">'2018'</span>, </span>
<span id="cb1-7"><a href="#cb1-7"></a>                            horizon<span class="op">=</span><span class="st">'1-Year'</span>, </span>
<span id="cb1-8"><a href="#cb1-8"></a>                            survey<span class="op">=</span><span class="st">'person'</span>)</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a>acs_data <span class="op">=</span> data_source.get_data(states<span class="op">=</span>[STATE], download<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-11"><a href="#cb1-11"></a></span>
<span id="cb1-12"><a href="#cb1-12"></a>acs_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>RT</th>
      <th>SERIALNO</th>
      <th>DIVISION</th>
      <th>SPORDER</th>
      <th>PUMA</th>
      <th>REGION</th>
      <th>ST</th>
      <th>ADJINC</th>
      <th>PWGTP</th>
      <th>AGEP</th>
      <th>...</th>
      <th>PWGTP71</th>
      <th>PWGTP72</th>
      <th>PWGTP73</th>
      <th>PWGTP74</th>
      <th>PWGTP75</th>
      <th>PWGTP76</th>
      <th>PWGTP77</th>
      <th>PWGTP78</th>
      <th>PWGTP79</th>
      <th>PWGTP80</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P</td>
      <td>2018GQ0000225</td>
      <td>8</td>
      <td>1</td>
      <td>300</td>
      <td>4</td>
      <td>8</td>
      <td>1013097</td>
      <td>26</td>
      <td>16</td>
      <td>...</td>
      <td>23</td>
      <td>4</td>
      <td>24</td>
      <td>33</td>
      <td>53</td>
      <td>46</td>
      <td>5</td>
      <td>4</td>
      <td>47</td>
      <td>42</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P</td>
      <td>2018GQ0000483</td>
      <td>8</td>
      <td>1</td>
      <td>4103</td>
      <td>4</td>
      <td>8</td>
      <td>1013097</td>
      <td>41</td>
      <td>19</td>
      <td>...</td>
      <td>7</td>
      <td>40</td>
      <td>39</td>
      <td>43</td>
      <td>41</td>
      <td>6</td>
      <td>41</td>
      <td>6</td>
      <td>41</td>
      <td>44</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P</td>
      <td>2018GQ0000529</td>
      <td>8</td>
      <td>1</td>
      <td>4101</td>
      <td>4</td>
      <td>8</td>
      <td>1013097</td>
      <td>16</td>
      <td>24</td>
      <td>...</td>
      <td>31</td>
      <td>16</td>
      <td>1</td>
      <td>32</td>
      <td>17</td>
      <td>15</td>
      <td>16</td>
      <td>17</td>
      <td>2</td>
      <td>18</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P</td>
      <td>2018GQ0000670</td>
      <td>8</td>
      <td>1</td>
      <td>818</td>
      <td>4</td>
      <td>8</td>
      <td>1013097</td>
      <td>3</td>
      <td>22</td>
      <td>...</td>
      <td>6</td>
      <td>3</td>
      <td>2</td>
      <td>7</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P</td>
      <td>2018GQ0000721</td>
      <td>8</td>
      <td>1</td>
      <td>819</td>
      <td>4</td>
      <td>8</td>
      <td>1013097</td>
      <td>17</td>
      <td>65</td>
      <td>...</td>
      <td>22</td>
      <td>0</td>
      <td>17</td>
      <td>37</td>
      <td>0</td>
      <td>0</td>
      <td>30</td>
      <td>16</td>
      <td>17</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 286 columns</p>
</div>
</div>
</div>
<p>It is evident that our dataset consists of a lot of columns, each representing a different feature of interest. Some of such features are race(RAC1P), sex(SEX), employment status(ESR), Marital status(MAR) and so on. However, for the purposes of this blog, we will only be using some of these features. The features I have chosen are age, race, disability record, nativity ,income and citizenship status because these factors are usually associated with allocative bias in different social contexts.</p>
<div class="cell" data-execution_count="2">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">#subsetting the features</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co"># Reducing number of features</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>possible_features<span class="op">=</span>[<span class="st">"PINCP"</span>, <span class="st">"RAC1P"</span>, <span class="st">"CIT"</span>,<span class="st">"SEX"</span>, <span class="st">"DIS"</span>,<span class="st">"AGEP"</span>,<span class="st">"NATIVITY"</span>]</span>
<span id="cb2-4"><a href="#cb2-4"></a>acs_data[possible_features]</span>
<span id="cb2-5"><a href="#cb2-5"></a>features_to_use <span class="op">=</span> [f <span class="cf">for</span> f <span class="kw">in</span> possible_features <span class="cf">if</span> f <span class="kw">not</span> <span class="kw">in</span> [<span class="st">"PINCP"</span>,<span class="st">"SEX"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>From the folktables library, we will be usig the BasicProblem class to make a problem to predict whether a not an individual’s income is greater that $50k based on their Race.</p>
<div class="cell" data-execution_count="3">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>IncomeProblem <span class="op">=</span> BasicProblem(</span>
<span id="cb3-2"><a href="#cb3-2"></a>    features<span class="op">=</span>features_to_use,</span>
<span id="cb3-3"><a href="#cb3-3"></a>    target<span class="op">=</span><span class="st">'PINCP'</span>, <span class="co">#total person's income</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>    target_transform<span class="op">=</span><span class="kw">lambda</span> x: <span class="dv">1</span><span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">50000</span>),</span>
<span id="cb3-5"><a href="#cb3-5"></a>    group<span class="op">=</span>[<span class="st">'SEX'</span>],</span>
<span id="cb3-6"><a href="#cb3-6"></a>    preprocess<span class="op">=</span><span class="kw">lambda</span> x: x,</span>
<span id="cb3-7"><a href="#cb3-7"></a>    postprocess<span class="op">=</span><span class="kw">lambda</span> x: np.nan_to_num(x, <span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb3-8"><a href="#cb3-8"></a>)</span>
<span id="cb3-9"><a href="#cb3-9"></a></span>
<span id="cb3-10"><a href="#cb3-10"></a>features, label, group <span class="op">=</span> IncomeProblem.df_to_numpy(acs_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Once we create the IncomeProblem object, we convert the dataframe to a numpy array that will feature three variables: features, label and group. We can then use these arrays to train our models. We will then be splitting out data set into training data and testing data. We can do so by using the train-test split class from the sklearn.model_selection model library. A test_size of 0.2 means that 20% of out dataset will be used for the testing dataset and 80% will be used as the training data set. After train-test split we will be ready to create a model and use our training data to train it.</p>
<div class="cell" data-execution_count="4">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb4-2"><a href="#cb4-2"></a>X_train, X_test, y_train, y_test, group_train, group_test <span class="op">=</span> train_test_split(</span>
<span id="cb4-3"><a href="#cb4-3"></a>    features, label, group, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="basic-descriptives" class="level1">
<h1>Basic Descriptives</h1>
<div class="cell" data-execution_count="5">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-2"><a href="#cb5-2"></a>df <span class="op">=</span> pd.DataFrame(X_train, columns <span class="op">=</span> features_to_use)</span>
<span id="cb5-3"><a href="#cb5-3"></a>df[<span class="st">"group"</span>] <span class="op">=</span> group_train</span>
<span id="cb5-4"><a href="#cb5-4"></a>df[<span class="st">"label"</span>] <span class="op">=</span> y_train</span>
<span id="cb5-5"><a href="#cb5-5"></a>df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>(44742, 7)</code></pre>
</div>
</div>
<p>The shape that the training dataset consists of 214,480 observations, with each instance having values for 7 different features.</p>
<p>Let’ see how many of these observations have an income of &lt;= to an income of $50,000. As shown in the output below, 79.39% of people in Colorado have an income of less that or equal to 50,000 dollars.</p>
<div class="cell" data-execution_count="6">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>income_gt_50k <span class="op">=</span> df[df[<span class="st">"label"</span>] <span class="op">==</span> <span class="dv">1</span>].shape[<span class="dv">0</span>]</span>
<span id="cb7-2"><a href="#cb7-2"></a>income_lt_50k <span class="op">=</span> df[df[<span class="st">"label"</span>] <span class="op">==</span> <span class="dv">0</span>].shape[<span class="dv">0</span>]</span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a>total_count <span class="op">=</span> df.shape[<span class="dv">0</span>]</span>
<span id="cb7-5"><a href="#cb7-5"></a>income_gt_50k_percent <span class="op">=</span> income_gt_50k <span class="op">/</span> total_count <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>income_lt_50k_percent <span class="op">=</span> income_lt_50k <span class="op">/</span> total_count <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb7-7"><a href="#cb7-7"></a></span>
<span id="cb7-8"><a href="#cb7-8"></a>results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb7-9"><a href="#cb7-9"></a>    <span class="st">"Income"</span>: [<span class="st">"&lt;= $50,000"</span>, <span class="st">"&gt; $50,000"</span>],</span>
<span id="cb7-10"><a href="#cb7-10"></a>    <span class="st">"Count"</span>: [income_lt_50k, income_gt_50k],</span>
<span id="cb7-11"><a href="#cb7-11"></a>    <span class="st">"Percentage"</span>: [income_lt_50k_percent, income_gt_50k_percent]</span>
<span id="cb7-12"><a href="#cb7-12"></a>})</span>
<span id="cb7-13"><a href="#cb7-13"></a></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="bu">print</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       Income  Count  Percentage
0  &lt;= $50,000  32972   73.693621
1   &gt; $50,000  11770   26.306379</code></pre>
</div>
</div>
<p>If we were to delve deeper, we can seethat out of the people who have an income higher than $50,000 dollars, 26.87% are male while 14.56% are females.</p>
<div class="cell" data-execution_count="7">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>income_gt_50k <span class="op">=</span> df[df[<span class="st">"label"</span>] <span class="op">==</span> <span class="dv">1</span>]</span>
<span id="cb9-2"><a href="#cb9-2"></a>male_income_gt_50k <span class="op">=</span> income_gt_50k[income_gt_50k[<span class="st">"group"</span>] <span class="op">==</span> <span class="dv">1</span>]</span>
<span id="cb9-3"><a href="#cb9-3"></a>female_income_gt_50k <span class="op">=</span> income_gt_50k[income_gt_50k[<span class="st">"group"</span>] <span class="op">==</span> <span class="dv">2</span>]</span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a>male_percent <span class="op">=</span> <span class="bu">len</span>(male_income_gt_50k) <span class="op">/</span> <span class="bu">len</span>(df[df[<span class="st">"group"</span>] <span class="op">==</span> <span class="dv">1</span>]) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>female_percent <span class="op">=</span> <span class="bu">len</span>(female_income_gt_50k) <span class="op">/</span> <span class="bu">len</span>(df[df[<span class="st">"group"</span>] <span class="op">==</span> <span class="dv">2</span>]) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb9-7"><a href="#cb9-7"></a></span>
<span id="cb9-8"><a href="#cb9-8"></a>results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb9-9"><a href="#cb9-9"></a>    <span class="st">"Group"</span>: [<span class="st">"Male"</span>, <span class="st">"Female"</span>],</span>
<span id="cb9-10"><a href="#cb9-10"></a>    <span class="st">"Percentage"</span>: [male_percent, female_percent]</span>
<span id="cb9-11"><a href="#cb9-11"></a>})</span>
<span id="cb9-12"><a href="#cb9-12"></a></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="bu">print</span>(results.to_string(index<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb9-14"><a href="#cb9-14"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Group  Percentage
  Male   32.725562
Female   19.915254</code></pre>
</div>
</div>
<p>The results produced from the code below shows the percentage of males that have an income of greater than $50,000 and percentage of female with an income greater than $50,000.</p>
<div class="cell" data-execution_count="8">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>income_gt_50k <span class="op">=</span> df[df[<span class="st">"label"</span>] <span class="op">==</span> <span class="dv">1</span>]</span>
<span id="cb11-2"><a href="#cb11-2"></a>income_count <span class="op">=</span> income_gt_50k.groupby(<span class="st">"group"</span>).size()</span>
<span id="cb11-3"><a href="#cb11-3"></a>total_count <span class="op">=</span> income_gt_50k.shape[<span class="dv">0</span>]</span>
<span id="cb11-4"><a href="#cb11-4"></a>income_percent <span class="op">=</span> income_count <span class="op">/</span> total_count <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb11-5"><a href="#cb11-5"></a></span>
<span id="cb11-6"><a href="#cb11-6"></a>results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb11-7"><a href="#cb11-7"></a>    <span class="st">"Group"</span>: [<span class="st">"Male"</span>, <span class="st">"Female"</span>],</span>
<span id="cb11-8"><a href="#cb11-8"></a>    <span class="st">"Count"</span>: <span class="bu">list</span>(income_count),</span>
<span id="cb11-9"><a href="#cb11-9"></a>    <span class="st">"Percentage"</span>: <span class="bu">list</span>(income_percent)</span>
<span id="cb11-10"><a href="#cb11-10"></a>})</span>
<span id="cb11-11"><a href="#cb11-11"></a></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="bu">print</span>(results.to_string(index<span class="op">=</span><span class="va">False</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Group  Count  Percentage
  Male   7305   62.064571
Female   4465   37.935429</code></pre>
</div>
</div>
<p>We can observe that 64% of the total male have an income greater than $50k while 36% of the total female population has an income greater than $50k. We can see the summarized findings in the chart belowe</p>
<div class="cell" data-execution_count="9">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a>fig, axs <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb13-4"><a href="#cb13-4"></a></span>
<span id="cb13-5"><a href="#cb13-5"></a>axs[<span class="dv">0</span>].bar([<span class="st">"Male"</span>, <span class="st">"Female"</span>], [male_percent, female_percent], color<span class="op">=</span>[<span class="st">"#5975a4"</span>, <span class="st">"#cc8a63"</span>])</span>
<span id="cb13-6"><a href="#cb13-6"></a>axs[<span class="dv">0</span>].set_ylim(<span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb13-7"><a href="#cb13-7"></a>axs[<span class="dv">0</span>].set_ylabel(<span class="st">"Percentage of Individuals with Income &gt; $50,000"</span>)</span>
<span id="cb13-8"><a href="#cb13-8"></a>axs[<span class="dv">0</span>].set_title(<span class="st">"Income &gt; $50,000 by Gender"</span>)</span>
<span id="cb13-9"><a href="#cb13-9"></a></span>
<span id="cb13-10"><a href="#cb13-10"></a>axs[<span class="dv">1</span>].bar(<span class="st">"Income &gt; $50K"</span>, income_percent[<span class="dv">1</span>], width<span class="op">=</span><span class="fl">0.1</span>, color<span class="op">=</span><span class="st">"#5975a4"</span>)</span>
<span id="cb13-11"><a href="#cb13-11"></a>axs[<span class="dv">1</span>].bar(<span class="st">"Income &gt; $50K"</span>, income_percent[<span class="dv">2</span>], bottom<span class="op">=</span>income_percent[<span class="dv">1</span>], width<span class="op">=</span><span class="fl">0.1</span>, color<span class="op">=</span><span class="st">"#cc8a63"</span>)</span>
<span id="cb13-12"><a href="#cb13-12"></a>axs[<span class="dv">1</span>].set_ylim(<span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb13-13"><a href="#cb13-13"></a>axs[<span class="dv">1</span>].set_ylabel(<span class="st">"Percentage of Individuals"</span>)</span>
<span id="cb13-14"><a href="#cb13-14"></a>axs[<span class="dv">1</span>].set_title(<span class="st">"Income &gt; $50K by Gender"</span>)</span>
<span id="cb13-15"><a href="#cb13-15"></a>axs[<span class="dv">1</span>].legend([<span class="st">"Male"</span>, <span class="st">"Female"</span>])</span>
<span id="cb13-16"><a href="#cb13-16"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="allocative_bias_files/figure-html/cell-10-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Now, let’s observe the relation of race and sex with income:</p>
<div class="cell" data-execution_count="10">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb14-4"><a href="#cb14-4"></a></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co"># Computing proportion of positive labels by race and sex</span></span>
<span id="cb14-6"><a href="#cb14-6"></a>race_proportion <span class="op">=</span> df.groupby([<span class="st">"RAC1P"</span>, <span class="st">"group"</span>], as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">"label"</span>].mean()</span>
<span id="cb14-7"><a href="#cb14-7"></a></span>
<span id="cb14-8"><a href="#cb14-8"></a>sns.set_style(<span class="st">"whitegrid"</span>)</span>
<span id="cb14-9"><a href="#cb14-9"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb14-10"><a href="#cb14-10"></a>ax <span class="op">=</span> sns.barplot(data<span class="op">=</span>race_proportion, x<span class="op">=</span><span class="st">"RAC1P"</span>, y<span class="op">=</span><span class="st">"label"</span>, hue<span class="op">=</span><span class="st">"group"</span>)</span>
<span id="cb14-11"><a href="#cb14-11"></a></span>
<span id="cb14-12"><a href="#cb14-12"></a>plt.title(<span class="st">"Distribution of Race and Sex with Income Over $50K"</span>)</span>
<span id="cb14-13"><a href="#cb14-13"></a>plt.xlabel(<span class="st">"Race Group"</span>)</span>
<span id="cb14-14"><a href="#cb14-14"></a>plt.ylabel(<span class="st">"Proportion of Individuals with Income Over $50K"</span>)</span>
<span id="cb14-15"><a href="#cb14-15"></a>handles, labels <span class="op">=</span> ax.get_legend_handles_labels()</span>
<span id="cb14-16"><a href="#cb14-16"></a>labels[<span class="dv">0</span>] <span class="op">=</span> <span class="st">"Male"</span></span>
<span id="cb14-17"><a href="#cb14-17"></a>labels[<span class="dv">1</span>] <span class="op">=</span> <span class="st">"Female"</span></span>
<span id="cb14-18"><a href="#cb14-18"></a>ax.legend(handles, labels, title<span class="op">=</span><span class="st">"Group"</span>)</span>
<span id="cb14-19"><a href="#cb14-19"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="allocative_bias_files/figure-html/cell-11-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>THe plot shows that for most race groups, there are more male populations with an income greater than 50k. The only exception to this is race group 4 which is “Alaska Native alone”. Further more we can also observe that Asian alone is the race with the highest proportion of individuals with an income greater than 50k collectively between both the genders.</p>
<p>Let’s also obeserve the relationship between nativity and Income.</p>
<div class="cell" data-execution_count="11">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co"># Computing proportion of positive labels by race and sex</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>cit_proportion <span class="op">=</span> df.groupby([<span class="st">"CIT"</span>, <span class="st">"group"</span>], as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">"label"</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="12">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb16-4"><a href="#cb16-4"></a></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co"># Computing proportion of positive labels by citizenship</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>cit_proportion <span class="op">=</span> df.groupby([<span class="st">"NATIVITY"</span>], as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">"label"</span>].mean()</span>
<span id="cb16-7"><a href="#cb16-7"></a></span>
<span id="cb16-8"><a href="#cb16-8"></a></span>
<span id="cb16-9"><a href="#cb16-9"></a>sns.set_style(<span class="st">"whitegrid"</span>)</span>
<span id="cb16-10"><a href="#cb16-10"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb16-11"><a href="#cb16-11"></a>sns.barplot(data<span class="op">=</span>cit_proportion, x<span class="op">=</span><span class="st">"NATIVITY"</span>, y<span class="op">=</span><span class="st">"label"</span>)</span>
<span id="cb16-12"><a href="#cb16-12"></a></span>
<span id="cb16-13"><a href="#cb16-13"></a>plt.title(<span class="st">"Distribution of Nativity with Income Over $50K"</span>)</span>
<span id="cb16-14"><a href="#cb16-14"></a>plt.xlabel(<span class="st">"Nativity"</span>)</span>
<span id="cb16-15"><a href="#cb16-15"></a>plt.ylabel(<span class="st">"Proportion of Individuals with Income Over $50K"</span>)</span>
<span id="cb16-16"><a href="#cb16-16"></a>plt.gca().set_xticklabels([<span class="st">"Native"</span>, <span class="st">"Foreign Born"</span>])</span>
<span id="cb16-17"><a href="#cb16-17"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="allocative_bias_files/figure-html/cell-13-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>As shown by the bar chart, the poportion of individuals with an income over 50k for Native Born are higher than Foreign Born in Colorado.</p>
</section>
<section id="implementing-a-model" class="level1">
<h1>Implementing a Model</h1>
<p>For our training data set, we will be using a decision tree model. It utilizes the Scikit-learn library to import the necessary modules, including SVC, LogisticRegression, make_pipeline, StandardScaler, confusion_matrix, cross_val_score, and DecisionTreeClassifier. The code also shows the process tuning a model and cross-validation for a decision tree classifier. It iterates over a range of depth values from 2 to 19. Inside the loop, a pipeline is created using make_pipeline, which includes StandardScaler for data preprocessing and DecisionTreeClassifier with the depth value. Cross-validation scores are calculated using cross_val_score with cross-validation of 10 folds. Finally, best depth is the depth value equating to the highest score.</p>
<div class="cell" data-execution_count="13">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> make_pipeline</span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score</span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb17-8"><a href="#cb17-8"></a></span>
<span id="cb17-9"><a href="#cb17-9"></a>scores <span class="op">=</span> []</span>
<span id="cb17-10"><a href="#cb17-10"></a>depths <span class="op">=</span> <span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">10</span>)</span>
<span id="cb17-11"><a href="#cb17-11"></a></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="cf">for</span> depth <span class="kw">in</span> depths:</span>
<span id="cb17-13"><a href="#cb17-13"></a>    pipeline <span class="op">=</span> make_pipeline(StandardScaler(), DecisionTreeClassifier(max_depth<span class="op">=</span>depth))</span>
<span id="cb17-14"><a href="#cb17-14"></a>    score <span class="op">=</span> cross_val_score(pipeline, X_train, y_train, cv<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb17-15"><a href="#cb17-15"></a>    scores.append(score.mean())</span>
<span id="cb17-16"><a href="#cb17-16"></a></span>
<span id="cb17-17"><a href="#cb17-17"></a>best_depth <span class="op">=</span> depths[np.argmax(scores)]</span>
<span id="cb17-18"><a href="#cb17-18"></a></span>
<span id="cb17-19"><a href="#cb17-19"></a>plt.plot(depths, scores, <span class="st">'-o'</span>)</span>
<span id="cb17-20"><a href="#cb17-20"></a>plt.xlabel(<span class="st">'Depth'</span>)</span>
<span id="cb17-21"><a href="#cb17-21"></a>plt.ylabel(<span class="st">'Cross-validation score'</span>)</span>
<span id="cb17-22"><a href="#cb17-22"></a>plt.title(<span class="st">'Accuracy by depth'</span>)</span>
<span id="cb17-23"><a href="#cb17-23"></a>plt.show()</span>
<span id="cb17-24"><a href="#cb17-24"></a></span>
<span id="cb17-25"><a href="#cb17-25"></a><span class="bu">print</span>(<span class="ss">f"The best depth is </span><span class="sc">{</span>best_depth<span class="sc">}</span><span class="ss"> with a CV score of </span><span class="sc">{</span><span class="bu">max</span>(scores)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="allocative_bias_files/figure-html/cell-14-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>The best depth is 9 with a CV score of 0.7433510512632892</code></pre>
</div>
</div>
<div class="cell" data-execution_count="41">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a>model <span class="op">=</span> make_pipeline(StandardScaler(),DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">9</span>))</span>
<span id="cb19-2"><a href="#cb19-2"></a>model.fit(X_train,y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>Pipeline(steps=[('standardscaler', StandardScaler()),
                ('decisiontreeclassifier',
                 DecisionTreeClassifier(max_depth=9))])</code></pre>
</div>
</div>
<p>After building the model, we can check the accuracy scores:</p>
<div class="cell" data-execution_count="42">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a>y_hat<span class="op">=</span>model.predict(X_test)</span>
<span id="cb21-2"><a href="#cb21-2"></a></span>
<span id="cb21-3"><a href="#cb21-3"></a>overall_accuracy <span class="op">=</span> model.score(X_test, y_test)</span>
<span id="cb21-4"><a href="#cb21-4"></a></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="bu">print</span>(<span class="ss">f"The overall accuracy of our model is: </span><span class="sc">{</span>overall_accuracy<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The overall accuracy of our model is: 0.7411943500804578</code></pre>
</div>
</div>
<div class="cell" data-execution_count="43">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a>tn, fp, fn, tp <span class="op">=</span> confusion_matrix(y_test, y_hat).ravel()</span>
<span id="cb23-2"><a href="#cb23-2"></a></span>
<span id="cb23-3"><a href="#cb23-3"></a>post_predictive <span class="op">=</span> tp <span class="op">/</span> (tp<span class="op">+</span>fp)</span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="bu">print</span>(<span class="ss">f"PPV: </span><span class="sc">{</span>post_predictive<span class="sc">}</span><span class="ss">"</span> )</span>
<span id="cb23-5"><a href="#cb23-5"></a></span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="co"># calculating fnr and fpr</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>fnr <span class="op">=</span> fn <span class="op">/</span> (fn <span class="op">+</span> tp)</span>
<span id="cb23-8"><a href="#cb23-8"></a>fpr <span class="op">=</span> fp <span class="op">/</span> (fp <span class="op">+</span> tn)</span>
<span id="cb23-9"><a href="#cb23-9"></a></span>
<span id="cb23-10"><a href="#cb23-10"></a><span class="bu">print</span>(<span class="ss">f"False Negative Rate (FNR): </span><span class="sc">{</span>fnr<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="bu">print</span>(<span class="ss">f"False Positive Rate (FPR): </span><span class="sc">{</span>fpr<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>PPV: 0.5055118110236221
False Negative Rate (FNR): 0.6697530864197531
False Positive Rate (FPR): 0.11390568319226119</code></pre>
</div>
</div>
<p>The PPV value indicates the reliability of positive predictions made by our model.This value means that when our model predicts an instance to belong to the positive class, it is correct about 50% times. This suggests that our model has high rate of false positives compared to true positives which means the model is struggling to accurately predict the positive class.</p>
<p>The false negative rate of about 67% indicates that our model failed to recognize 60% of actual positive instances, and thus categorized them as negative. Also, 11.3% of actual negative instances were incorrectly classified as positive by our model as indicated by the falce positicve score.</p>
<div class="cell" data-execution_count="44">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># Calculating accuracy for male</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>male_indices <span class="op">=</span> group_test <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>male_indices <span class="op">=</span> np.squeeze(male_indices)</span>
<span id="cb25-4"><a href="#cb25-4"></a></span>
<span id="cb25-5"><a href="#cb25-5"></a>male_y_test <span class="op">=</span> y_test[male_indices]</span>
<span id="cb25-6"><a href="#cb25-6"></a>male_y_hat <span class="op">=</span> y_hat[male_indices]</span>
<span id="cb25-7"><a href="#cb25-7"></a></span>
<span id="cb25-8"><a href="#cb25-8"></a>male_accuracy <span class="op">=</span> np.mean(male_y_hat <span class="op">==</span> male_y_test)</span>
<span id="cb25-9"><a href="#cb25-9"></a></span>
<span id="cb25-10"><a href="#cb25-10"></a>male_tn, male_fp, male_fn, male_tp <span class="op">=</span> confusion_matrix(male_y_test, male_y_hat).ravel()</span>
<span id="cb25-11"><a href="#cb25-11"></a>male_fnr <span class="op">=</span> male_fn <span class="op">/</span> (male_fn <span class="op">+</span> male_tp)</span>
<span id="cb25-12"><a href="#cb25-12"></a>male_fpr <span class="op">=</span> male_fp <span class="op">/</span> (male_fp <span class="op">+</span> male_tn)</span>
<span id="cb25-13"><a href="#cb25-13"></a></span>
<span id="cb25-14"><a href="#cb25-14"></a><span class="bu">print</span>(<span class="ss">f"The accuracy score for males is </span><span class="sc">{</span>male_accuracy<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-15"><a href="#cb25-15"></a><span class="bu">print</span>(<span class="ss">f"The False Negative Rate (FNR) for males is</span><span class="sc">{</span>male_fnr<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-16"><a href="#cb25-16"></a><span class="bu">print</span>(<span class="ss">f"The False Positive Rate (FPR) for males is </span><span class="sc">{</span>male_fpr<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb25-17"><a href="#cb25-17"></a></span>
<span id="cb25-18"><a href="#cb25-18"></a><span class="co"># Calculating accuracy female </span></span>
<span id="cb25-19"><a href="#cb25-19"></a>female_indices <span class="op">=</span> group_test <span class="op">==</span> <span class="dv">2</span></span>
<span id="cb25-20"><a href="#cb25-20"></a>female_indices <span class="op">=</span> np.squeeze(female_indices)</span>
<span id="cb25-21"><a href="#cb25-21"></a></span>
<span id="cb25-22"><a href="#cb25-22"></a>female_y_test <span class="op">=</span> y_test[female_indices]</span>
<span id="cb25-23"><a href="#cb25-23"></a>female_y_hat <span class="op">=</span> y_hat[female_indices]</span>
<span id="cb25-24"><a href="#cb25-24"></a></span>
<span id="cb25-25"><a href="#cb25-25"></a>female_accuracy <span class="op">=</span> np.mean(female_y_hat <span class="op">==</span> female_y_test)</span>
<span id="cb25-26"><a href="#cb25-26"></a></span>
<span id="cb25-27"><a href="#cb25-27"></a>female_tn, female_fp, female_fn, female_tp <span class="op">=</span> confusion_matrix(female_y_test, female_y_hat).ravel()</span>
<span id="cb25-28"><a href="#cb25-28"></a>female_fnr <span class="op">=</span> female_fn <span class="op">/</span> (female_fn <span class="op">+</span> female_tp)</span>
<span id="cb25-29"><a href="#cb25-29"></a>female_fpr <span class="op">=</span> female_fp <span class="op">/</span> (female_fp <span class="op">+</span> female_tn)</span>
<span id="cb25-30"><a href="#cb25-30"></a></span>
<span id="cb25-31"><a href="#cb25-31"></a><span class="bu">print</span>(<span class="ss">f"The accuracy for females is </span><span class="sc">{</span>female_accuracy<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-32"><a href="#cb25-32"></a><span class="bu">print</span>(<span class="ss">f"The False Negative Rate (FNR) for females is </span><span class="sc">{</span>female_fnr<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-33"><a href="#cb25-33"></a><span class="bu">print</span>(<span class="ss">f"The False Positive Rate (FPR) for females is </span><span class="sc">{</span>female_fpr<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The accuracy score for males is 0.7074805288896939
The False Negative Rate (FNR) for males is0.6748099891422367
The False Positive Rate (FPR) for males is 0.1011144332699103

The accuracy for females is 0.7740511915269197
The False Negative Rate (FNR) for females is 0.6610800744878957
The False Positive Rate (FPR) for females is 0.12415595730777608
</code></pre>
</div>
</div>
<p>Although the model performs relatively well for both subgroups, there is a slight difference in accuracy, with females having a slightly higher accuracy compared to males. We will thus examine if our model is accurately calibrated.</p>
<div class="cell" data-execution_count="45">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a></span>
<span id="cb27-2"><a href="#cb27-2"></a>male_indices <span class="op">=</span> np.where(group_test <span class="op">==</span> <span class="dv">1</span>)[<span class="dv">0</span>]</span>
<span id="cb27-3"><a href="#cb27-3"></a>male_y_hat <span class="op">=</span> y_hat[male_indices]</span>
<span id="cb27-4"><a href="#cb27-4"></a>male_y_test <span class="op">=</span> y_test[male_indices]</span>
<span id="cb27-5"><a href="#cb27-5"></a></span>
<span id="cb27-6"><a href="#cb27-6"></a></span>
<span id="cb27-7"><a href="#cb27-7"></a>female_indices <span class="op">=</span> np.where(group_test <span class="op">==</span> <span class="dv">2</span>)[<span class="dv">0</span>]</span>
<span id="cb27-8"><a href="#cb27-8"></a>female_y_hat <span class="op">=</span> y_hat[female_indices]</span>
<span id="cb27-9"><a href="#cb27-9"></a>female_y_test <span class="op">=</span> y_test[female_indices]</span>
<span id="cb27-10"><a href="#cb27-10"></a></span>
<span id="cb27-11"><a href="#cb27-11"></a>matrix_male <span class="op">=</span> confusion_matrix(male_y_test, male_y_hat)</span>
<span id="cb27-12"><a href="#cb27-12"></a>calibration_male <span class="op">=</span> matrix_male[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">/</span> matrix_male[<span class="dv">0</span>].<span class="bu">sum</span>()</span>
<span id="cb27-13"><a href="#cb27-13"></a>matrix_female <span class="op">=</span> confusion_matrix(female_y_test, female_y_hat)</span>
<span id="cb27-14"><a href="#cb27-14"></a>calibration_female <span class="op">=</span> matrix_female[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">/</span> matrix_female[<span class="dv">0</span>].<span class="bu">sum</span>()</span>
<span id="cb27-15"><a href="#cb27-15"></a></span>
<span id="cb27-16"><a href="#cb27-16"></a><span class="bu">print</span>(<span class="ss">f"correctly predicted positive instances for men:  </span><span class="sc">{</span>calibration_male<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb27-17"><a href="#cb27-17"></a><span class="bu">print</span>(<span class="ss">f"correctly predicted positive instances for female:  </span><span class="sc">{</span>calibration_female<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>correctly predicted positive instances for men:  0.8988855667300897
correctly predicted positive instances for female:  0.8758440426922239</code></pre>
</div>
</div>
<p>The process of Calibration involves checking if the predicted probabilities align with the predicted outcomes. For males, the proportion of correctly predicted positive instances (income greater than $50k) was approximately 0.879. Similarly, for women, the proportion of correctly predicted positive instances was approximately 0.843. Thus, the model appears to be relatively well calibrated for both males and females. In terms of the error rate balance, the fpr for men and fpr for women only has a difference of about 0.03 and about the same for fnr. Hence, the model does not show any significant imbalances in the error rates.</p>
<p>Human Resources Departments in companies in Colorado could make a good use of our model to support salary adjustments across different genders. If the model was to show significant biases, it could lead to unfair treatment or discrimination against certain demographic groups. However in case of male and female in our model, there wasn’t a significant bias, hence the impact of deploying your model for large-scale prediction might not cause problems. However, the accuracy scores for male indicates than the model with get it’s predictions wrong for about 29 out of every 100 males and 24 out of every 100 females. These scores will have to be improved, if the model were to be used in any significant industry or decision making process.</p>
<p>It is important to consider bias across other features as well and also to consider bias amongst other genders that are not male and female. Hence, I would believe, a lot more experiments are needed to be carried out before implementing this model in any large-scale prediction. Based on my bias audit, the model is not showing any significant problematic bias but as I mentioned earlie,r considering other features and expanding the dataset is essential in using the model for any significant predictions.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© 2023 Anweshan Adhikari</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>